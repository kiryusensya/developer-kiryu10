<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>_.k__yu.10</title>
    <link rel="icon" href="https://static.wixstatic.com/media/2f0694_eb4d3063598a4cc5b6bd6b8e31cba915~mv2.png/v1/crop/x_248,y_0,w_1065,h_950/fill/w_816,h_728,al_c,q_90,usm_0.66_1.00_0.01,enc_avif,quality_auto/1767545356653.png">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&family=Noto+Sans+KR:wght@400;500;700&family=Outfit:wght@400;700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <script src="https://unpkg.com/lucide@latest"></script>
    
    <style>
        /* =========================================
           FONT DEFINITIONS & LICENSE NOTICE
           ========================================= */

        /* License Notice:
           HarmonyOS Sans Fonts Software is licensed under HarmonyOS Sans Fonts License Agreement.
           Copyright 2021 Huawei Device Co., Ltd.
           
           Required Notice:
           This software uses HarmonyOS Sans Fonts.
        */

        /* 1. HarmonyOS Sans (Global / English / Numbers) */
        @font-face {
            font-family: 'HarmonyOS Sans';
            src: url('./assets/fonts/HarmonyOS_Sans_Regular.woff') format('woff'); 
            font-weight: 400;
            font-style: normal;
        }
        @font-face {
            font-family: 'HarmonyOS Sans';
            src: url('./assets/fonts/HarmonyOS_Sans_Bold.woff') format('woff'); 
            font-weight: 700;
            font-style: normal;
        }

        /* 2. HarmonyOS Sans SC (Simplified Chinese) */
        @font-face {
            font-family: 'HarmonyOS Sans SC';
            src: url('./assets/fonts/HarmonyOS_SansSC_Regular.woff') format('woff'); 
            font-weight: 400;
            font-style: normal;
        }
        @font-face {
            font-family: 'HarmonyOS Sans SC';
            src: url('./assets/fonts/HarmonyOS_SansSC_Bold.woff') format('woff'); 
            font-weight: 700;
            font-style: normal;
        }

        /* =========================================
           DESIGN SETTINGS
           ========================================= */
        :root {
            /* メインカラー：紫 */
            --primary-color: #8407de; 
            /* ホバー時の青 */
            --hover-blue: #3b82f6; 
            
            --glass-bg: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
            --text-main: #ffffff;
            --text-muted: rgba(255, 255, 255, 0.7);
            --neon-cyan: #00f7ff;
            --neon-green: #00ff9d;
            /* エラー時の赤 */
            --neon-red: #ff2a2a; 
            
            /* 成功時の緑2色 */
            --success-green-light: #099c16;
            --success-green-dark: #047016;
        }

        /* 全要素に対して余白計算を統一 */
        *, *::before, *::after {
            box-sizing: border-box;
        }

        body {
            margin: 0; padding: 0; min-height: 100vh;
            display: flex; flex-direction: column; align-items: center;
            color: var(--text-main);
            background-image: url('https://static.wixstatic.com/media/2f0694_4d2ff9ae44cb47edad6e3bb1f8b83ae2~mv2.jpg/v1/fill/w_1200,h_750,al_c,q_85,usm_0.66_1.00_0.01,enc_avif,quality_auto/jia-kongno-huo-xingya-xingwo-chitsu3ci-yuan-kong-jianshin.jpg');
            background-size: cover; background-position: center; background-attachment: fixed;
            overflow-x: hidden;
            width: 100%;
        }

        /* =========================================
           LANGUAGE-SPECIFIC FONT STACKS
           ========================================= */
        
        /* 日本語 (ja) */
        html[lang="ja"] body, html[lang="ja"] input, html[lang="ja"] button, html[lang="ja"] select, html[lang="ja"] textarea {
            font-family: "HarmonyOS Sans", "Noto Sans JP", sans-serif;
        }
        /* 英語 (en) */
        html[lang="en"] body, html[lang="en"] input, html[lang="en"] button {
            font-family: "HarmonyOS Sans", sans-serif;
        }
        /* 中国語 (zh) */
        html[lang="zh"] body, html[lang="zh"] input, html[lang="zh"] button {
            font-family: "HarmonyOS Sans", "HarmonyOS Sans SC", "Microsoft YaHei", sans-serif;
        }
        /* 韓国語 (ko) */
        html[lang="ko"] body, html[lang="ko"] input, html[lang="ko"] button {
            font-family: "HarmonyOS Sans", "Noto Sans KR", "Malgun Gothic", sans-serif;
        }
        /* ロシア語 (ru) */
        html[lang="ru"] body, html[lang="ru"] input, html[lang="ru"] button {
            font-family: "HarmonyOS Sans", sans-serif;
        }

        /* コード入力欄は常に英語フォント優先 */
        .code-input {
            font-family: "HarmonyOS Sans", sans-serif !important;
        }

        body::before {
            content: ''; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.5); z-index: -1;
        }

        /* --- 共通コンポーネント --- */
        .glass-panel {
            background: var(--glass-bg); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
            border: 1px solid var(--glass-border); box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
        }

        /* --- ヘッダー --- */
        header {
            width: 100%; max-width: 1200px; padding: 20px;
            display: flex; justify-content: space-between; align-items: center; margin-bottom: 40px;
        }
        .logo { font-size: 24px; font-weight: 700; letter-spacing: 1px; display: flex; align-items: center; gap: 10px; }
        .header-right { display: flex; align-items: center; gap: 20px; }
        .lang-select {
            background: rgba(0,0,0,0.3); border: 1px solid var(--glass-border); color: white;
            padding: 5px 10px; border-radius: 20px; outline: none; cursor: pointer;
            font-family: inherit;
        }
        .lang-select option { background-color: #333; color: white; }

        .profile-img {
            width: 45px; height: 45px; border-radius: 50%;
            background-image: url('https://static.wixstatic.com/media/2f0694_bd65f14c98474408a7f54e430a57f9a3~mv2.jpg/v1/fill/w_1126,h_1488,al_c,q_85,usm_0.66_1.00_0.01,enc_avif,quality_auto/Gemini_Generated_Image_iu9ecaiu9ecaiu9e_.jpg');
            background-size: cover; border: 2px solid rgba(255,255,255,0.5);
            flex-shrink: 0;
        }

        /* --- メインコンテンツ --- */
        .container {
            width: 100%; max-width: 1000px; padding: 0 20px;
            flex: 1; display: flex; flex-direction: column; justify-content: center;
        }
        .grid-menu { display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 30px; margin-bottom: 50px; }
        .menu-card {
            border-radius: 24px; padding: 40px 30px; text-align: center;
            transition: transform 0.3s ease, background 0.3s ease; cursor: default;
            display: flex; flex-direction: column; align-items: center;
            width: 100%;
        }
        .menu-card:hover { transform: translateY(-10px); background: rgba(255, 255, 255, 0.15); }
        .card-icon-box {
            width: 80px; height: 80px; background: rgba(255,255,255,0.1); border-radius: 50%;
            display: flex; justify-content: center; align-items: center; margin-bottom: 20px; color: #60a5fa;
        }
        .card-title { font-size: 22px; font-weight: bold; margin: 0 0 10px 0; }
        .card-desc { font-size: 14px; color: var(--text-muted); margin: 0 0 25px 0; line-height: 1.6; }
        
        /* ★通常ボタン用アニメーション★ */
        @keyframes pulse-primary {
            0% { box-shadow: 0 0 10px rgba(132, 7, 222, 0.5), 0 0 5px rgba(132, 7, 222, 0.3); }
            50% { box-shadow: 0 0 25px rgba(132, 7, 222, 0.8), 0 0 15px rgba(132, 7, 222, 0.5); }
            100% { box-shadow: 0 0 10px rgba(132, 7, 222, 0.5), 0 0 5px rgba(132, 7, 222, 0.3); }
        }
        @keyframes pulse-blue-fast {
            0% { box-shadow: 0 0 15px rgba(59, 130, 246, 0.6), 0 0 10px rgba(59, 130, 246, 0.4); }
            50% { box-shadow: 0 0 35px rgba(59, 130, 246, 1.0), 0 0 20px rgba(59, 130, 246, 0.7); }
            100% { box-shadow: 0 0 15px rgba(59, 130, 246, 0.6), 0 0 10px rgba(59, 130, 246, 0.4); }
        }

        .btn-action {
            display: inline-flex; align-items: center; gap: 8px; padding: 12px 30px; border-radius: 50px;
            background: var(--primary-color);
            color: white; text-decoration: none; font-weight: bold; font-size: 15px;
            border: 1px solid rgba(255,255,255,0.2); 
            cursor: pointer; transition: background 0.3s, transform 0.2s;
            font-family: inherit; justify-content: center;
            max-width: 100%;
            animation: pulse-primary 2s infinite ease-in-out;
        }
        
        .btn-action:hover { 
            background: var(--hover-blue); 
            transform: scale(1.05); 
            border-color: rgba(59, 130, 246, 0.8);
            animation: pulse-blue-fast 1.0s infinite ease-in-out; 
        }

        footer { padding: 20px; font-size: 13px; color: var(--text-muted); text-align: center; width: 100%; }
        .footer-link { color: white; text-decoration: none; border-bottom: 1px dotted white; }

        /* --- 言語選択 --- */
        #langSelectionOverlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.85); backdrop-filter: blur(15px);
            z-index: 9999;
            display: flex; justify-content: center; align-items: center;
            transition: opacity 0.5s ease, visibility 0.5s ease;
            padding: 20px;
        }
        .lang-modal {
            width: 100%; max-width: 500px; padding: 40px; text-align: center; border-radius: 24px;
        }
        .lang-grid {
            display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin-top: 30px;
        }
        .lang-grid button:last-child:nth-child(odd) {
            grid-column: span 2;
        }

        /* --- モーダル --- */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.6); backdrop-filter: blur(8px);
            display: flex; justify-content: center; align-items: center; z-index: 2000;
            opacity: 0; visibility: hidden; transition: opacity 0.4s ease, visibility 0.4s ease;
            padding: 10px;
        }
        .modal-overlay.active { opacity: 1; visibility: visible; }

        .modal-container {
            width: 100%; max-width: 480px; border-radius: 24px; padding: 40px; text-align: center;
            position: relative; transform: scale(0.9); transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
            max-height: 90vh; overflow-y: auto;
            display: flex; flex-direction: column;
        }
        .modal-overlay.active .modal-container { transform: scale(1); }
        
        /* ------------------------------------------------------------- */
        /* ★アニメーション定義★ */
        /* ------------------------------------------------------------- */
        
        /* 1. 緑色アニメーション (デフォルト) */
        @keyframes anim-green {
            0% {
                border-color: var(--success-green-light);
                box-shadow: 0 0 15px rgba(9, 156, 22, 0.4), 0 0 5px rgba(9, 156, 22, 0.2);
            }
            50% {
                border-color: var(--neon-green); 
                box-shadow: 0 0 40px rgba(9, 156, 22, 0.8), 0 0 20px rgba(9, 156, 22, 0.5);
            }
            100% {
                border-color: var(--success-green-light);
                box-shadow: 0 0 15px rgba(9, 156, 22, 0.4), 0 0 5px rgba(9, 156, 22, 0.2);
            }
        }

        /* 2. 青紫ミックスアニメーション (ホバー時 - メインボックス枠線用) */
        @keyframes anim-box-blue-purple {
            0% {
                border-color: #0066ff;
                box-shadow: 0 0 15px rgba(0, 102, 255, 0.4), 0 0 5px rgba(0, 102, 255, 0.2);
            }
            50% {
                border-color: #aa00ff;
                box-shadow: 0 0 25px rgba(170, 0, 255, 0.6), 0 0 10px rgba(170, 0, 255, 0.3);
            }
            100% {
                border-color: #0066ff;
                box-shadow: 0 0 15px rgba(0, 102, 255, 0.4), 0 0 5px rgba(0, 102, 255, 0.2);
            }
        }

        /* 3. 青紫ミックスアニメーション (ホバー時 - バッジ & ボタン用) */
        @keyframes anim-badge-blue-purple {
            0% {
                border-color: #0066ff;
                background: rgba(0, 102, 255, 0.15);
                box-shadow: 0 0 15px rgba(0, 102, 255, 0.4);
            }
            50% {
                border-color: #aa00ff;
                background: rgba(170, 0, 255, 0.15);
                box-shadow: 0 0 25px rgba(170, 0, 255, 0.6);
            }
            100% {
                border-color: #0066ff;
                background: rgba(0, 102, 255, 0.15);
                box-shadow: 0 0 15px rgba(0, 102, 255, 0.4);
            }
        }
        
        /* 4. アイコン(SVG)用 */
        @keyframes anim-svg-mixed {
            0% { filter: drop-shadow(0 0 5px rgba(0, 102, 255, 0.8)); }
            50% { filter: drop-shadow(0 0 5px rgba(170, 0, 255, 0.8)); }
            100% { filter: drop-shadow(0 0 5px rgba(0, 102, 255, 0.8)); }
        }


        /* --- モーダル設定 (通常時：緑) --- */
        .modal-container.wide-mode {
            max-width: 900px;
            padding: 0;
            display: flex;
            flex-direction: row;
            overflow: hidden;
            border: 2px solid var(--success-green-light);
            /* デフォルトは緑アニメーション */
            animation: anim-green 3s infinite ease-in-out;
            transition: border-color 0.3s ease;
        }
        
        /* --- モーダル設定 (ホバー連動時：青紫) --- */
        #modalContainer.wide-mode.sync-blue-mode {
            /* !importantで確実に適用 */
            animation: anim-box-blue-purple 3s infinite ease-in-out !important;
            border-color: #0066ff !important; /* 初期値を鮮やかな青に */
        }

        .modal-close {
            position: absolute; top: 20px; right: 20px; cursor: pointer; color: rgba(255,255,255,0.6); transition: color 0.2s; z-index: 100;
        }
        .modal-close:hover { color: white; }

        #inputPhase { width: 100%; }
        .modal-title { font-size: 26px; margin-bottom: 10px; font-weight: bold; word-break: break-all; }
        .modal-sub { font-size: 14px; color: var(--text-muted); margin-bottom: 30px; }
        .input-wrapper { margin-bottom: 25px; }
        
        .code-input {
            width: 100%; box-sizing: border-box; background: rgba(0, 0, 0, 0.3);
            border: 1px solid var(--glass-border); border-radius: 12px; padding: 16px;
            color: white; font-size: 18px; text-align: center;
            letter-spacing: 0em; 
            /* font-familyは上で定義済み */
            outline: none; transition: all 0.3s;
            text-transform: uppercase;
        }
        .code-input:focus { border-color: var(--primary-color); box-shadow: 0 0 20px rgba(132, 7, 222, 0.5); }
        
        .btn-confirm {
            width: 100%; padding: 16px; border-radius: 12px; background: var(--primary-color);
            color: white; border: none; font-size: 16px; font-weight: bold; cursor: pointer;
            transition: all 0.2s; display: flex; justify-content: center; align-items: center;
            min-height: 56px; box-sizing: border-box; font-family: inherit;
            border: 1px solid rgba(255,255,255,0.2);
            animation: pulse-primary 2s infinite ease-in-out;
        }
        
        .btn-confirm:hover { 
            background: var(--hover-blue); 
            transform: translateY(-2px); 
            border-color: rgba(59, 130, 246, 0.8);
            animation: pulse-blue-fast 1.0s infinite ease-in-out; 
        }
        
        .btn-confirm:disabled { 
            background: var(--primary-color); opacity: 0.8; cursor: wait; transform: none; 
            animation: none; 
            box-shadow: none;
        }

        /* --- エラー時の赤発光クラス --- */
        .btn-confirm.error-glow {
            border-color: var(--neon-red) !important;
            box-shadow: 0 0 25px rgba(255, 42, 42, 0.8) !important;
            animation: none !important; 
            background-color: rgba(255, 42, 42, 0.7) !important; 
            color: white !important; 
        }
        .code-input.error-glow {
            border-color: var(--neon-red) !important;
            box-shadow: 0 0 25px rgba(255, 42, 42, 0.8) !important;
        }
        .modal-error-border {
            border: 2px solid var(--neon-red) !important;
            box-shadow: 0 0 30px rgba(255, 42, 42, 0.8) !important;
            transition: all 0.3s;
        }
        
        #successPhase { display: none; width: 100%; height: 100%; }
        .success-layout { display: flex; width: 100%; min-height: 500px; }
        .success-left { flex: 1; background-color: rgba(0,0,0,0.3); position: relative; display: none; }
        .success-left img { width: 100%; height: 100%; object-fit: cover; position: absolute; top: 0; left: 0; }
        .success-right { flex: 1.2; padding: 40px; display: flex; flex-direction: column; justify-content: center; align-items: flex-start; text-align: left; }

        /* ★成功バッジ（チェックマーク）の設定 */
        .success-tag {
            background: rgba(9, 156, 22, 0.2);
            border: 2px solid var(--success-green-light);
            color: var(--neon-green);
            padding: 8px 16px; border-radius: 30px; font-size: 14px; font-weight: bold; margin-bottom: 20px; 
            display: inline-flex; align-items: center; gap: 8px;
            text-shadow: 0 0 8px rgba(0, 255, 157, 0.6); 
            font-family: inherit;
            white-space: nowrap;
            /* 通常時は緑アニメーション */
            animation: anim-green 3s infinite ease-in-out;
            transition: all 0.3s ease;
        }
        .success-tag svg { filter: drop-shadow(0 0 5px rgba(0, 255, 157, 0.8)); flex-shrink: 0; transition: all 0.3s ease; }

        /* ★★★ 連動モード適用：バッジ（枠線アニメーション + 文字色固定） ★★★ */
        #modalContainer.wide-mode.sync-blue-mode .success-tag {
            /* 枠線と背景のアニメーション（青⇔紫） */
            animation: anim-badge-blue-purple 3s infinite ease-in-out !important;
            /* 文字色は鮮やかな青固定（点滅させない） */
            color: #0066ff !important;
            text-shadow: none !important;
            border-color: #0066ff !important;
        }
        /* アイコンも青固定（点滅させない） */
        #modalContainer.wide-mode.sync-blue-mode .success-tag svg {
             filter: drop-shadow(0 0 5px rgba(0, 102, 255, 0.8)) !important;
             animation: none !important;
        }
        
        .success-title-main { font-size: 28px; font-weight: bold; margin-bottom: 20px; line-height: 1.3; }
        .success-info-box { background: rgba(255,255,255,0.05); border-radius: 12px; padding: 20px; width: 100%; box-sizing: border-box; margin-bottom: 25px; }
        .success-label { font-size: 12px; color: var(--text-muted); }
        
        /* ★コンテンツ名テキスト */
        .success-content { 
            font-size: 18px; font-weight: bold; margin-top: 5px; 
            /* 通常時：緑色で光る */
            color: var(--neon-green); 
            word-break: break-all;
            text-shadow: 0 0 5px rgba(0, 255, 157, 0.5); 
            transition: color 0.3s ease, text-shadow 0.3s ease;
        }

        /* ★★★ 連動モード適用：コンテンツ名 ★★★ */
        /* 鮮やかな青色(#0066ff)にするが、光らせない（text-shadow: none） */
        #modalContainer.wide-mode.sync-blue-mode .success-content {
            color: #0066ff !important;
            text-shadow: none !important;
            animation: none !important;
        }

        .success-extra { font-size: 14px; margin-top: 10px; color: #ddd; white-space: pre-wrap; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 10px;}

        .btn-group { display: flex; gap: 15px; width: 100%; flex-wrap: wrap; }
        
        /* ★成功時のダウンロードボタン */
        #successDownloadBtn { 
            flex: 2; text-decoration: none; text-align: center; min-width: 140px;
            background: #099c16 !important;
            border: 2px solid var(--success-green-light) !important;
            /* 通常時は緑アニメーション */
            animation: anim-green 3s infinite ease-in-out !important;
        }
        #successDownloadBtn:hover {
            background: var(--hover-blue) !important;
            /* ホバー時：青紫ミックスアニメーション（枠線と影） */
            animation: anim-badge-blue-purple 3s infinite ease-in-out !important;
            transform: translateY(-2px);
            border-color: #0066ff !important;
        }

        #modalCloseSub {
            flex: 1; background: transparent; border: 2px solid rgba(255,255,255,0.3); color: white;
            padding: 16px; border-radius: 12px; font-size: 16px; font-weight: bold; cursor: pointer;
            transition: all 0.2s; display: flex; justify-content: center; align-items: center;
            min-height: 56px; box-sizing: border-box; font-family: inherit;
            min-width: 100px;
        }
        #modalCloseSub:hover { background: rgba(255,255,255,0.1); border-color: #fff; }

        /* --- 問い合わせ(Support)用スタイル --- */
        .modal-container.wide-support-mode {
            max-width: 900px; /* PCで5列並べるため幅を確保 */
            padding: 40px;
        }

        .support-grid {
            display: grid;
            gap: 15px;
            margin-bottom: 30px;
            width: 100%;
        }

        /* PC: 5列 */
        @media (min-width: 769px) {
            .support-grid {
                grid-template-columns: repeat(5, 1fr);
            }
        }

        .support-item {
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            padding: 20px;
            background: rgba(255,255,255,0.05);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            text-decoration: none;
            color: white;
            transition: 0.3s;
            /* ★縦長の長方形に変更 */
            height: 220px;
            text-align: center;
        }
        
        /* FontAwesomeアイコンのサイズと色調整 */
        .support-item i { 
            font-size: 48px; /* アイコンを大きく */
            margin-bottom: 20px; 
            color: var(--neon-cyan); 
            transition: color 0.3s, transform 0.3s; 
        }
        .support-item span { font-size: 14px; font-weight: bold; }
        
        .support-item:hover {
            background: rgba(255,255,255,0.2);
            transform: translateY(-8px);
            border-color: var(--primary-color);
            box-shadow: 0 0 15px rgba(132, 7, 222, 0.4);
        }
        .support-item:hover i { 
            color: var(--primary-color); 
            transform: scale(1.1); /* ホバー時にアイコンも少し拡大 */
        }

        /* --- モバイル専用調整 --- */
        @media (max-width: 768px) {
            header { padding: 15px; margin-bottom: 20px; }
            .logo { font-size: 20px; }
            .header-right { gap: 10px; }
            .container { padding: 0 15px; }
            .grid-menu { gap: 20px; }

            .modal-container.wide-mode { flex-direction: column; max-width: 100%; overflow-y: auto; height: auto; }
            .success-layout { flex-direction: column; }
            .success-left { width: 100%; min-height: 200px; display: block; position: relative; }
            .success-left img { position: relative; height: 200px; }
            .success-right { padding: 30px 20px; align-items: center; text-align: center; width: 100%; }
            .success-info-box { text-align: left; }
            .success-right { align-items: stretch; }
            .lang-grid { grid-template-columns: 1fr; }
            .lang-grid button:last-child:nth-child(odd) { grid-column: span 1; }

            /* サポートモーダル：スマホレイアウト (上2列・下3列) */
            .support-grid {
                /* 6カラムグリッドにして、spanで調整する */
                grid-template-columns: repeat(6, 1fr);
            }
            /* 上側2つ：それぞれ3カラム分使う (計6) -> 横2列になる */
            .support-item:nth-child(1),
            .support-item:nth-child(2) {
                grid-column: span 3;
            }
            /* 下側3つ：それぞれ2カラム分使う (計6) -> 横3列になる */
            .support-item:nth-child(3),
            .support-item:nth-child(4),
            .support-item:nth-child(5) {
                grid-column: span 2;
            }
            
            /* スマホでは高さを少し抑えるが、それでも縦長感を維持 */
            .support-item { padding: 15px 5px; height: 160px; }
            .support-item i { font-size: 36px; margin-bottom: 15px; }
            .support-item span { font-size: 12px; }
        }

        @media (max-width: 480px) {
            .lang-modal { padding: 30px 20px; }
            .modal-container { padding: 30px 20px; }
            .card-title { font-size: 20px; }
            .success-title-main { font-size: 22px; }
            
            .btn-group {
                gap: 10px;
            }
            #successDownloadBtn, #modalCloseSub {
                width: auto;
                flex: 1;
                min-width: 0;
            }
        }

        #statusContainer { margin-top: 15px; font-size: 14px; }
        .error-msg { color: #ff6b6b; display: flex; align-items: center; justify-content: center; gap: 5px; }

        /* --- 近未来的なローディングスピナー --- */
        .cyber-spinner {
            position: relative;
            width: 26px;
            height: 26px;
            display: inline-block;
            margin-right: 12px;
            border-radius: 50%;
            animation: pulse-core 1.5s ease-in-out infinite alternate;
        }

        .cyber-spinner::before {
            content: '';
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            border: 2px solid transparent;
            border-top-color: var(--neon-cyan);
            border-bottom-color: var(--neon-cyan);
            border-radius: 50%;
            animation: spin-cyber 0.8s linear infinite;
            filter: drop-shadow(0 0 4px var(--neon-cyan));
        }

        .cyber-spinner::after {
            content: '';
            position: absolute;
            top: 4px; left: 4px;
            width: calc(100% - 8px);
            height: calc(100% - 8px);
            border: 2px solid transparent;
            border-top-color: #ffffff;
            border-right-color: var(--primary-color);
            border-radius: 50%;
            animation: spin-cyber-reverse 1.8s linear infinite;
            filter: drop-shadow(0 0 3px var(--primary-color));
        }

        @keyframes pulse-core {
            0% { box-shadow: 0 0 2px var(--primary-color), inset 0 0 2px var(--neon-cyan); }
            100% { box-shadow: 0 0 10px var(--neon-cyan), inset 0 0 8px var(--primary-color); }
        }
        @keyframes spin-cyber { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        @keyframes spin-cyber-reverse { 0% { transform: rotate(0deg); } 100% { transform: rotate(-360deg); } }


        .loading-dots::after {
            display: inline-block; animation: dot-steps 1.5s infinite steps(1);
            content: '.'; width: 1.2em; text-align: left;
        }
        @keyframes dot-steps { 0% { content: '.'; } 33% { content: '..'; } 67% { content: '...'; } }

    </style>
</head>
<body>

    <div id="langSelectionOverlay">
        <div class="glass-panel lang-modal">
            <div class="logo" style="justify-content:center; margin-bottom:20px;">
                <i data-lucide="globe" size="32" style="color: #9347FF;"></i>
            </div>
            <h2 style="font-size: 24px; margin-bottom: 10px;">Select Language</h2>
            <p style="color:rgba(255,255,255,0.7); font-size:14px;">言語を選択してください</p>
            
            <div class="lang-grid">
                <button class="btn-action" onclick="setInitialLanguage('ja')">日本語</button>
                <button class="btn-action" onclick="setInitialLanguage('en')">English</button>
                <button class="btn-action" onclick="setInitialLanguage('zh')">中文</button>
                <button class="btn-action" onclick="setInitialLanguage('ko')">한국어</button>
                <button class="btn-action" onclick="setInitialLanguage('ru')">Русский</button>
            </div>

            <div style="margin-top: 30px; font-size: 12px; color: rgba(255,255,255,0.5); opacity:0.8;">
                Enforcement Administer:kiryu-sensya
            </div>
        </div>
    </div>

    <header>
        <div class="logo"><i data-lucide="user-round-check" style="color: #9347FF;"></i>_.k__yu.10</div>
        <div class="header-right">
            <select id="languageSwitcher" class="lang-select glass-panel">
                <option value="ja" selected>日本語</option>
                <option value="en">English</option>
                <option value="zh">中文</option>
                <option value="ko">한국어</option>
                <option value="ru">Русский</option>
            </select>
            <div class="profile-img"></div>
        </div>
    </header>

    <div class="container">
        <div class="grid-menu">
            <div class="menu-card glass-panel">
                <div class="card-icon-box"><i data-lucide="key" size="40"></i></div>
                <h3 class="card-title" data-translate="card1_title">アクセス解放</h3>
                <p class="card-desc" data-translate="card1_desc">コードを入力して<br>限定コンテンツをアンロック</p>
                <button id="btnOpenModal" class="btn-action">
                    <span data-translate="card1_btn">コードを入力</span><i data-lucide="download" size="16"></i>
                </button>
            </div>

            <div class="menu-card glass-panel">
                <div class="card-icon-box" style="color: #f472b6;"><i data-lucide="newspaper" size="40"></i></div>
                <h3 class="card-title" data-translate="card2_title">ニュース</h3>
                <p class="card-desc" data-translate="card2_desc">このサイトに関する<br>最新のアップデート情報</p>
                <button id="btnOpenNews" class="btn-action">
                    <span data-translate="card2_btn">確認する</span><i data-lucide="circle-fading-arrow-up" size="16"></i>
                </button>
            </div>

            <div class="menu-card glass-panel">
                <div class="card-icon-box" style="color: #34d399;"><i data-lucide="message-circle" size="40"></i></div>
                <h3 class="card-title" data-translate="card3_title">サポート</h3>
                <p class="card-desc" data-translate="card3_desc">コードが無効な場合などは<br>こちらからご連絡ください</p>
                <button id="btnOpenSupport" class="btn-action" style="background: rgba(255,255,255,0.1);">
                    <span data-translate="card3_btn">問い合わせ</span><i data-lucide="arrow-up-right" size="16"></i>
                </button>
            </div>
        </div>
    </div>

    <footer>
        Enforcement Administer: <a href="https://lit.link/kiryusensya" target="_blank" class="footer-link">kiryu-sensya</a>
        <br><span style="opacity: 0.5; font-size: 11px;">© 2019-2026 kiryu-sensya. All rights reserved.</span>
    </footer>

    <div id="authModal" class="modal-overlay">
        <div class="modal-container glass-panel" id="modalContainer">
            <div class="modal-close" id="modalCloseBtn"><i data-lucide="x"></i></div>

            <div id="inputPhase">
                <h2 class="modal-title" data-translate="modal_title">アクセス解放</h2>
                <p class="modal-sub" data-translate="modal_sub">コードを入力してください。</p>
                <div class="input-wrapper">
                    <input type="text" id="activationCode" class="code-input" placeholder="コードを入力" autocomplete="off">
                </div>
                <button id="btnConfirm" class="btn-confirm" data-translate="modal_btn_auth">認証する</button>
                <div id="statusContainer"></div>
            </div>

            <div id="successPhase">
                <div class="success-layout">
                    <div class="success-left" id="successLeftCol">
                        <img id="successImage" src="" alt="Result Image">
                    </div>
                    
                    <div class="success-right">
                        
                        <div class="success-tag">
                            <i data-lucide="circle-check-big" size="23"></i>
                            <span data-translate="success_badge">アクセスが承認されました</span>
                        </div>
                        
                        <h2 class="success-title-main" data-translate="success_main_title">解放されたコンテンツリスト</h2>
                        
                        <div class="success-info-box">
                            <div class="success-label" data-translate="success_label_name">コンテンツ名称</div>
                            <div class="success-content" id="successTitle">Loading...</div>
                            <div class="success-extra" id="successExtraInfo"></div>
                        </div>

                        <div class="btn-group">
                            <button id="modalCloseSub" data-translate="btn_close">
                                閉じる
                            </button>
                            <a href="#" id="successDownloadBtn" class="btn-confirm" data-translate="btn_download">
                                ダウンロード
                            </a>
                        </div>

                    </div>
                </div>
            </div>

        </div>
    </div>

    <div id="newsModal" class="modal-overlay">
        <div class="modal-container glass-panel">
            <div class="modal-close" id="newsCloseX"><i data-lucide="x"></i></div>

            <h2 class="modal-title" style="margin-bottom: 30px;" data-translate="news_title">最新情報</h2>
            <div style="text-align: left; background: rgba(0,0,0,0.2); padding: 20px; border-radius: 12px; margin-bottom: 30px;">
                <h3 style="font-size: 18px; color: var(--neon-cyan); margin: 0 0 10px 0;">
                    <i data-lucide="info" size="16" style="vertical-align: middle; margin-right:5px;"></i>
                    <span data-translate="news_label">変更ログ</span>
                </h3>
                <p style="line-height: 1.6; margin: 0;" data-translate="news_content">
                    韓国語,ロシア語が追加されました。
                    1度限り使用可能なコードを発行しました。
                </p>
            </div>

            <button id="newsCloseBtn" class="btn-confirm" data-translate="btn_close">閉じる</button>
        </div>
    </div>

    <div id="supportModal" class="modal-overlay">
        <div class="modal-container glass-panel wide-support-mode">
            <div class="modal-close" id="supportCloseX"><i data-lucide="x"></i></div>

            <h2 class="modal-title" style="margin-bottom: 10px;" data-translate="support_modal_title">お問い合わせ</h2>
            <p class="modal-sub" data-translate="support_modal_sub">連絡先を選択してください</p>
            
            <div class="support-grid">
                <a href="#" class="support-item">
                    <i class="fa-brands fa-playstation"></i>
                    <span>PlayStation</span>
                </a>
                <a href="#" class="support-item">
                    <i class="fa-brands fa-xbox"></i>
                    <span>Xbox</span>
                </a>
                <a href="#" class="support-item">
                    <i class="fa-brands fa-discord"></i>
                    <span>Discord</span>
                </a>
                <a href="#" class="support-item">
                    <i class="fa-brands fa-github"></i>
                    <span>GitHub</span>
                </a>
                <a href="#" class="support-item">
                    <i class="fa-brands fa-instagram"></i>
                    <span>Instagram</span>
                </a>
            </div>

            <button id="supportCloseBtn" class="btn-confirm" data-translate="btn_close">閉じる</button>
        </div>
    </div>

<script>
    lucide.createIcons();
    const GAS_API_URL = "https://script.google.com/macros/s/AKfycbwFVUjphTbnkGeGdMrAP3U8uN5kJSsYUjVS4yJhtlL41pRwW15paLkBMLWA7y4i2boNEQ/exec"; 
    let CURRENT_LANG = "ja"; 

    // --- 翻訳データ ---
    const TRANSLATIONS = {
        ja: {
            card1_title: "アクセス解放", card1_desc: "コードを入力して<br>限定コンテンツをアンロック", card1_btn: "コードを入力",
            card2_title: "ニュース", card2_desc: "このサイトに関する<br>最新のアップデート情報", card2_btn: "確認する",
            card3_title: "サポート", card3_desc: "コードが無効な場合などは<br>こちらからご連絡ください", card3_btn: "問い合わせ",
            modal_title: "アクセス解放", modal_sub: "コードを入力してください。",
            modal_placeholder: "コードを入力", modal_btn_auth: "認証する",
            msg_verifying: "確認中",
            msg_invalid: "このコードは無効です。", 
            msg_used: "このコードは既に使用済みです。", 
            msg_error: "通信エラーが発生しました",
            success_badge: "アクセスが承認されました", success_main_title: "解放されたコンテンツリスト",
            success_label_name: "コンテンツ名称", btn_close: "閉じる", btn_download: "ダウンロード",
            news_title: "最新情報", news_label: "変更ログ", news_content: "韓国語,ロシア語が追加されました。<br>1度限り使用可能なコードを発行しました。",
            // Support Modal
            support_modal_title: "お問い合わせ", support_modal_sub: "連絡先を選択してください"
        },
        en: {
            card1_title: "Access Unlock", card1_desc: "Enter code to unlock<br>exclusive content", card1_btn: "Enter Code",
            card2_title: "News", card2_desc: "Latest updates <br>about this site.", card2_btn: "Check",
            card3_title: "Support", card3_desc: "Contact us if your code<br>is invalid or missing.", card3_btn: "Contact Us",
            modal_title: "Access Unlock", modal_sub: "Please enter your code.",
            modal_placeholder: "Enter Code", modal_btn_auth: "CHECK",
            msg_verifying: "Checking",
            msg_invalid: "This code is invalid.",
            msg_used: "This code has already been used.",
            msg_error: "Connection error occurred.",
            success_badge: "Your access has been authorized.", success_main_title: "List of Available Content",
            success_label_name: "Content Name", btn_close: "Close", btn_download: "Download",
            news_title: "Latest News", news_label: "Changelog", news_content: "Korean and Russian have been added.<br> A one-time use code has been issued.",
            support_modal_title: "Contact Support", support_modal_sub: "Select a platform"
        },
        zh: {
            card1_title: "访问解锁", card1_desc: "输入代码以解锁<br>独家内容", card1_btn: "输入代码",
            card2_title: "新闻", card2_desc: "本网站的<br>最新更新信息", card2_btn: "查看",
            card3_title: "支持", card3_desc: "如果代码无效<br>请联系我们", card3_btn: "联系我们",
            modal_title: "访问解锁", modal_sub: "请输入您的激活码",
            modal_placeholder: "输入代码", modal_btn_auth: "检查",
            msg_verifying: "正在检查",
            msg_invalid: "该代码无效。",
            msg_used: "该代码已被使用。",
            msg_error: "发生通信错误",
            success_badge: "访问已批准", success_main_title: "可用内容列表",
            success_label_name: "内容名称", btn_close: "关闭", btn_download: "下载",
            news_title: "最新消息", news_label: "更新日志", news_content: "韩语、俄语已新增支持。<br>已为您生成仅限一次性使用的代码。",
            support_modal_title: "联系支持", support_modal_sub: "选择平台"
        },
        ko: {
            card1_title: "액세스 해제", card1_desc: "코드를 입력하여<br>한정 콘텐츠 잠금 해제", card1_btn: "코드 입력",
            card2_title: "뉴스", card2_desc: "이 사이트에 관한<br>최신 업데이트 정보", card2_btn: "확인",
            card3_title: "지원", card3_desc: "코드가 유효하지 않은 경우<br>여기로 연락주십시오", card3_btn: "문의하기",
            modal_title: "액세스 해제", modal_sub: "보유하신 활성화 코드를 입력해 주세요",
            modal_placeholder: "코드 입력", modal_btn_auth: "인증하기",
            msg_verifying: "확인 중",
            msg_invalid: "유효하지 않은 코드입니다.",
            msg_used: "이미 사용된 코드입니다.",
            msg_error: "통신 오류가 발생했습니다",
            success_badge: "액세스 승인됨", success_main_title: "이용 가능한 콘텐츠 목록",
            success_label_name: "콘텐츠 명칭", btn_close: "닫기", btn_download: "다운로드",
            news_title: "최신 정보", news_label: "변경 내역", news_content: "한국어, 러시아어가 추가되었습니다.<br>1회 한정 사용 가능한 코드를 발행했습니다.",
            support_modal_title: "문의하기", support_modal_sub: "연락처를 선택하세요"
        },
        ru: {
            card1_title: "Доступ", card1_desc: "Введите код для разблокировки<br>эксклюзивного контента", card1_btn: "Ввод кода",
            card2_title: "Новости", card2_desc: "Последние обновления<br>о проекте", card2_btn: "Проверить",
            card3_title: "Поддержка", card3_desc: "Свяжитесь с нами, если<br>код недействителен", card3_btn: "Связаться",
            modal_title: "Активация", modal_sub: "Пожалуйста, введите ваш код активации",
            modal_placeholder: "Введите код", modal_btn_auth: "Войти",
            msg_verifying: "Проверка",
            msg_invalid: "Неверный код.",
            msg_used: "Код уже использован.",
            msg_error: "Ошибка соединения",
            success_badge: "Доступ разрешен", success_main_title: "Доступный контент",
            success_label_name: "Название", btn_close: "Закрыть", btn_download: "Скачать",
            news_title: "Новости", news_label: "Список изменений", news_content: "Добавлены корейский и русский языки.<br>Выдан одноразовый код.",
            support_modal_title: "Поддержка", support_modal_sub: "Выберите платформу"
        }
    };

    // --- DOM要素 ---
    const authModal = document.getElementById('authModal');
    const modalContainer = document.getElementById('modalContainer');
    const openAuthBtn = document.getElementById('btnOpenModal');
    const closeAuthBtn = document.getElementById('modalCloseBtn');
    const closeSubBtn = document.getElementById('modalCloseSub');
    
    const inputPhase = document.getElementById('inputPhase');
    const successPhase = document.getElementById('successPhase');
    
    const codeInput = document.getElementById('activationCode');
    const confirmBtn = document.getElementById('btnConfirm');
    const statusContainer = document.getElementById('statusContainer');
    
    const successTitle = document.getElementById('successTitle');
    const successExtraInfo = document.getElementById('successExtraInfo');
    const successDownloadBtn = document.getElementById('successDownloadBtn');
    const successLeftCol = document.getElementById('successLeftCol');
    const successImage = document.getElementById('successImage');

    // --- ★言語設定とローカルストレージ連携 ---
    
    // ページ読み込み時に実行: 保存された言語があれば即反映してオーバーレイを消す
    document.addEventListener('DOMContentLoaded', () => {
        const savedLang = localStorage.getItem('user_lang');
        const overlay = document.getElementById('langSelectionOverlay');
        const switcher = document.getElementById('languageSwitcher');

        if (savedLang) {
            // 保存済みの場合: 即時非表示にして言語セット
            overlay.style.display = 'none'; 
            switcher.value = savedLang;
            updateLanguage(savedLang);
        } else {
            // 初回訪問時: オーバーレイを表示（CSSで制御されているが念のため）
            // 何もしなくてOK
        }
    });

    // 初回選択ボタンが押された時の処理
    function setInitialLanguage(lang) {
        localStorage.setItem('user_lang', lang); // 保存
        
        updateLanguage(lang);
        document.getElementById('languageSwitcher').value = lang;
        
        const overlay = document.getElementById('langSelectionOverlay');
        overlay.style.opacity = '0';
        overlay.style.visibility = 'hidden';
        setTimeout(() => { overlay.style.display = 'none'; }, 500);
    }

    // ヘッダーのセレクトボックス変更時の処理
    document.getElementById('languageSwitcher').addEventListener('change', (e) => {
        const lang = e.target.value;
        localStorage.setItem('user_lang', lang); // 保存
        updateLanguage(lang);
    });

    // 言語切り替えロジック
    function updateLanguage(lang) {
        CURRENT_LANG = lang;
        
        // HTMLのlang属性を更新
        document.documentElement.lang = lang;

        const t = TRANSLATIONS[lang];
        if(!t) return;

        document.querySelectorAll('[data-translate]').forEach(el => {
            const key = el.getAttribute('data-translate');
            if(t[key]) el.innerHTML = t[key];
        });

        if(t.modal_placeholder) {
            codeInput.placeholder = t.modal_placeholder;
        }
    }

    // --- 認証モーダル操作 ---
    function openAuthModal() { authModal.classList.add('active'); resetAuthModal(); codeInput.focus(); }
    function closeAuthModal() { authModal.classList.remove('active'); }
    
    function resetAuthModal() {
        modalContainer.classList.remove('wide-mode');
        inputPhase.style.display = 'block';
        successPhase.style.display = 'none';
        codeInput.value = "";
        codeInput.disabled = false;
        confirmBtn.disabled = false;
        
        // クラス初期化
        modalContainer.classList.remove('modal-error-border');
        codeInput.classList.remove('error-glow');
        confirmBtn.classList.remove('error-glow');
        
        const t = TRANSLATIONS[CURRENT_LANG];
        confirmBtn.textContent = t.modal_btn_auth;
        
        statusContainer.innerHTML = "";
        successImage.src = "";
        successLeftCol.style.display = 'none';
    }

    openAuthBtn.addEventListener('click', openAuthModal);
    closeAuthBtn.addEventListener('click', closeAuthModal);
    closeSubBtn.addEventListener('click', closeAuthModal);
    authModal.addEventListener('click', (e) => { if (e.target === authModal) closeAuthModal(); });

    // --- ニュースモーダル操作 ---
    const newsModal = document.getElementById('newsModal');
    const btnOpenNews = document.getElementById('btnOpenNews');
    const newsCloseX = document.getElementById('newsCloseX');
    const newsCloseBtn = document.getElementById('newsCloseBtn');

    function openNewsModal() {
        newsModal.classList.add('active');
        lucide.createIcons(); // アイコン再描画
    }
    function closeNewsModal() {
        newsModal.classList.remove('active');
    }

    if(btnOpenNews) btnOpenNews.addEventListener('click', openNewsModal);
    if(newsCloseX) newsCloseX.addEventListener('click', closeNewsModal);
    if(newsCloseBtn) newsCloseBtn.addEventListener('click', closeNewsModal);
    if(newsModal) newsModal.addEventListener('click', (e) => { if (e.target === newsModal) closeNewsModal(); });

    // --- ★サポートモーダル操作 (新規追加) ---
    const supportModal = document.getElementById('supportModal');
    const btnOpenSupport = document.getElementById('btnOpenSupport');
    const supportCloseX = document.getElementById('supportCloseX');
    const supportCloseBtn = document.getElementById('supportCloseBtn');

    function openSupportModal() {
        supportModal.classList.add('active');
        lucide.createIcons(); // アイコン再描画
    }
    function closeSupportModal() {
        supportModal.classList.remove('active');
    }

    if(btnOpenSupport) btnOpenSupport.addEventListener('click', openSupportModal);
    if(supportCloseX) supportCloseX.addEventListener('click', closeSupportModal);
    if(supportCloseBtn) supportCloseBtn.addEventListener('click', closeSupportModal);
    if(supportModal) supportModal.addEventListener('click', (e) => { if (e.target === supportModal) closeSupportModal(); });


    // --- 入力フォーマット制御 (25文字以上で5文字区切り) ---
    codeInput.addEventListener('input', (e) => {
        let val = codeInput.value.toUpperCase().replace(/[^A-Z0-9]/g, '');
        let chunkSize = (val.length >= 25) ? 5 : 4;
        let formatted = '';
        for(let i=0; i<val.length; i++){
            if(i>0 && i % chunkSize === 0) formatted += '-';
            formatted += val[i];
        }
        codeInput.value = formatted;
    });

    // --- 認証ロジック ---
    confirmBtn.addEventListener('click', async () => {
        const code = codeInput.value.trim();
        if(!code) return;
        
        const t = TRANSLATIONS[CURRENT_LANG];

        codeInput.disabled = true;
        confirmBtn.disabled = true;
        confirmBtn.innerHTML = `<span class="cyber-spinner"></span> ${t.msg_verifying}<span class="loading-dots"></span>`;
        statusContainer.innerHTML = "";
        
        // エラーグローは一旦消す
        modalContainer.classList.remove('modal-error-border');
        codeInput.classList.remove('error-glow');
        confirmBtn.classList.remove('error-glow');

        const requestUrl = `${GAS_API_URL}?key=${encodeURIComponent(code)}&lang=${CURRENT_LANG}`;
        try {
            const response = await fetch(requestUrl);
            const data = await response.json();
            
            codeInput.disabled = false; 
            confirmBtn.disabled = false; 
            confirmBtn.textContent = t.modal_btn_auth; 

            if (data.success) {
                modalContainer.classList.add('wide-mode');
                inputPhase.style.display = 'none';
                
                successPhase.style.display = 'block';
                successPhase.animate([
                    { opacity: 0, transform: 'translateY(10px)' },
                    { opacity: 1, transform: 'translateY(0)' }
                ], { duration: 500, easing: 'ease-out' });

                successTitle.textContent = data.message;
                successExtraInfo.textContent = data.extraInfo;
                successDownloadBtn.textContent = data.buttonLabel || t.btn_download;
                successDownloadBtn.href = data.actionUrl;

                if (data.imageUrl && data.imageUrl.startsWith("http")) {
                    successImage.src = data.imageUrl;
                    successLeftCol.style.display = 'block';
                } else {
                    successLeftCol.style.display = 'none';
                }
                
                lucide.createIcons();
            } else {
                // --- エラー時の処理 ---
                let errorMsg = t.msg_invalid;
                if (data.message === "This code has already been used.") {
                    errorMsg = t.msg_used;
                }
                statusContainer.innerHTML = `<span class="error-msg"><i data-lucide="alert-circle" size="14"></i> ${errorMsg}</span>`;
                lucide.createIcons();
                shakeModal();
                
                // ★赤く光らせる (3秒)
                modalContainer.classList.add('modal-error-border');
                codeInput.classList.add('error-glow');
                confirmBtn.classList.add('error-glow');
                
                setTimeout(() => {
                    modalContainer.classList.remove('modal-error-border');
                    codeInput.classList.remove('error-glow');
                    confirmBtn.classList.remove('error-glow');
                }, 3000);
            }
        } catch (error) {
            console.error(error);
            codeInput.disabled = false; 
            confirmBtn.disabled = false; 
            confirmBtn.textContent = t.modal_btn_auth;
            statusContainer.innerHTML = `<span class="error-msg">${t.msg_error}</span>`;
            
            // ★通信エラー時も赤く光らせる
            modalContainer.classList.add('modal-error-border');
            codeInput.classList.add('error-glow');
            confirmBtn.classList.add('error-glow');
            
            setTimeout(() => {
                modalContainer.classList.remove('modal-error-border');
                codeInput.classList.remove('error-glow');
                confirmBtn.classList.remove('error-glow');
            }, 3000);
        }
    });

    function shakeModal() {
        modalContainer.animate([
            { transform: 'translateX(0)' }, { transform: 'translateX(-10px)' },
            { transform: 'translateX(10px)' }, { transform: 'translateX(0)' }
        ], { duration: 300 });
    }

    // --- ダウンロードボタンのホバー連動 (JS実装) ---
    successDownloadBtn.addEventListener('mouseenter', () => {
        modalContainer.classList.add('sync-blue-mode');
    });
    successDownloadBtn.addEventListener('mouseleave', () => {
        modalContainer.classList.remove('sync-blue-mode');
    });

</script>
</body>
</html>
